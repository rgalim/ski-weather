# SkiWeatherApp

SkiWeatherApp is a Kotlin-based application designed to provide weather forecasts and historical weather data for ski areas. Built using the Ktor framework, it leverages dependency injection with Koin and integrates with external weather APIs to deliver accurate and up-to-date weather information.

## Project Overview

SkiWeatherApp is a server-side application that offers weather forecasts and historical data for ski areas. It uses Ktor for handling HTTP requests and responses, and Koin for dependency injection. The application fetches data from a weather API and provides endpoints for retrieving weather forecasts and historical weather data for specified locations.

### Key Features

- Fetch current weather forecasts for ski areas.
- Retrieve historical weather data for ski areas.
- Handle API errors gracefully with custom exception handling.
- Modular architecture with clear separation of concerns.

## Installation Instructions

### Prerequisites

- **Kotlin**: Ensure you have Kotlin installed on your machine.
- **Gradle**: The project uses Gradle as the build tool.
- **Java**: Java Development Kit (JDK) 17 or higher is required.
- **Environment Variables**: Set the following environment variables:
    - `WEATHER_API_URL`: The base URL for the weather API.
    - `WEATHER_API_KEY`: Your API key for accessing the weather API.

### Steps

1. **Clone the Repository**:
   ```bash
   git clone https://github.com/yourusername/skiweatherapp.git
   cd skiweatherapp
   ```

2. **Build the Project**:
   ```bash
   ./gradlew build
   ```

3. **Run the Application**:
   ```bash
   ./gradlew run
   ```

The server will start on port 8000 by default.

## Usage Examples

### Fetch Weather Forecast

To fetch the weather forecast for a specific location, you can use the following endpoint:

```
GET /forecast?location={location}&days={days}
```

- **location**: The name of the location (e.g., "Aspen").
- **days**: Number of days for the forecast (e.g., 3).

### Fetch Weather History

To retrieve historical weather data for a specific location, use the following endpoint:

```
GET /history?location={location}
```

- **location**: The name of the location (e.g., "Aspen").

## Configuration and Key Components

### Configuration

The application configuration is managed through the `AppConfig` data class, which loads the API URL and key from environment variables:

```kotlin
data class AppConfig(
    val weatherApiUrl: String,
    val weatherApiKey: String,
)
```

### Key Components

- **SkiWeatherApp.kt**: The main entry point of the application. It sets up the Ktor server, installs necessary plugins, and defines routing for the application.

- **WeatherApiClient.kt**: Handles communication with the external weather API, fetching both forecast and historical weather data.

- **KoinModule.kt**: Defines the dependency injection module using Koin, specifying how various services and clients are provided.

- **WeatherService.kt**: Provides methods to fetch weather forecasts and historical data, converting API responses into application-specific models.

- **SkiArea.kt**: Represents a ski area with associated weather and condition data.

### Error Handling

The application uses Ktor's `StatusPages` plugin to handle exceptions such as `WeatherApiException` and `IllegalArgumentException`, providing meaningful HTTP responses for different error scenarios.

The README.md file is generated by the [readme-agent](https://github.com/rgalim/readme-agent)